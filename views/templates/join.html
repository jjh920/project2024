{% extends 'base.html' %}

{% block style %}
    <style>
        /* 기본으로 생기는 파란 라인 제거*/
        input:focus, textarea:focus, button:focus {
            outline:none;
        }

        .btn {
            -webkit-tap-highlight-color: transparent;
        }

        body {
            /*font-family: Arial, sans-serif;*/
            font-family: "Orbit", sans-serif;
            font-weight: 400;
            font-style: normal;
            {#padding-top : 500px;#}
            {#margin: 240px;#}
            background-color: #E8E8E8;
            {#padding: 0;#}
        }

        .container {
            max-width: 400px; /* 수정: 너비를 조금 더 넓게 설정 */
            margin: 50px auto;
            background-color: #fff;
            padding: 50px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(210, 210, 210, 0.1);
        }

        .form-group {
            text-align: left;
            margin-bottom: 20px;
            display: block;
            justify-content: center; /* 수평 가운데 정렬 */
        }
        .form-group label {
            padding-right: 200px;
            margin-left: 3px;
            margin-top: -10px;
            /* margin-bottom: 2px; /* login은 10px*/
            {#display: block;#}
            font-weight: bold;
        }

        .form-group input[type="text"],
        .form-group input[type="password"],
        .form-group textarea {
            width: 100%;
            padding: 10px;
            margin-top: -5px;

            border: 1px solid #ccc;
            border-radius: 1px;
            box-sizing: border-box;
        }

        .form-select {
            padding: 10px;
            margin-bottom: 5px;
            border: 1px solid #ccc;
        }

        .form-control.btn-outline-primary {
            margin-top: 10px;
            width: 100% ;
            background-color: #f4f4f4;
            text-align: center;
            font-size: 14px;
            color: black;
            border: 1px solid #ccc ;
            padding: 14px;
            cursor: pointer;
            border-radius: 0;
        }

        .form-control.btn-outline-primary:hover {
            color: white;
            border: 1px solid transparent ;
            background-color: black;
        }

    </style>
{% endblock %}

{% block main %}
    <main>
        <form name="joinfrm">
            <div class="container">

                <div class="col-auto">
                    <div class="form-group">
                    <!-- 중복확인 버튼 만들기-->
                        <label for="userid" class="col-form-label">아이디</label>
                        <input type="text" name="userid" id="userid" class="form-control" placeholder="영문과 숫자 5~15자"><span id="msg1"></span><span id="code1"></span>
                    {# <div class="col-md-7 offset-md-1"><button type="button" class="btn btn-success btn-sm" name="checkbtn" id="checkbtn"><i class="bi bi-check"></i> 아이디 중복확인&nbsp;</button></div>#}
                        <!-- 확인 후 readonly로 변경시켜야함. -->
                        <!-- 동일 작업 전화번호, 이메일 시키기, 이건 확인버튼 x -->
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-group">
                        <label for="passwd" class="col-form-label">비밀번호</label>
                        <input type="password" name="passwd" id="passwd" class="form-control" placeholder="영문과 숫자 5~15자"><span id="msg2"></span>
                    </div>
                </div>

                <div class="col-auto">
                    <div class="form-group">
                        <label for="repwd" class="col-form-label">비밀번호확인</label>
                        <input type="password" name="repwd" id="repwd" class="form-control"><span id="msg3"></span>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-group">
                        <div class="row">
                            <div class="header-actions-action header-actions-action--cta preFade fadeIn" data-animation-role="header-element" style="transition-timing-function: ease; transition-duration: 0.8s; transition-delay: 0.272727s; animation-duration: 0.8s;">
                                <button type="button" class="form-control btn btn-outline-primary btn-lg theme-btn--primary-inverse sqs-button-element--primary" onclick="execDaumPostcode()" value="우편번호 찾기" style="transition-timing-function: ease; transition-duration: 0.4s; transition-delay: 0.172727s; animation-duration: 0.4s;">FIND ADDRESS</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- zipcode 검색 나오는 위치 -->
                <div id="wrap" style="display:none;border:1px solid;width:500px;height:300px;margin:5px 0;position:relative">
                    <img src="//t1.daumcdn.net/postcode/resource/images/close.png" id="btnFoldWrap" style="cursor:pointer;position:absolute;right:0;top:-1px;z-index:1" onclick="foldDaumPostcode()" alt="접기 버튼">
                </div>
                <div class="col-auto">
                    <div class="form-group">
                        <label for="zipcode" class="col-form-label" style="margin-bottom: -20px">우편번호</label>
                    </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            {# <label for="zipcode" class="col-form-label">우편번호</label>#}
                            <input type="text" name="zipcode" id="zipcode" class="form-control" style="width: 140px" readonly>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="form-group">
                            <input type="text" id="extraAddress" placeholder="참고주소" class="form-control" style="width: 140px" readonly>
                        </div>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-group">
                        <label for="address1" class="col-form-label">주소</label>
                        <input type="text" name="address1" id="address1" placeholder="" class="form-control" readonly>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-group">
                        <label for="address2" class="col-form-label">상세주소 입력</label>
                        <input type="text" name="address2" id="address2" class="form-control"><span id="msgAdd"></span>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-group">
                        <label for="name" class="col-form-label">이름</label>
                        <input type="text" name="name" id="name" class="form-control"><span id="msg4"></span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-form-label">휴대전화</label>
                    <select class="form-select form-select-sm rounded-0" aria-label="mobile1" id="mobile1" style="width: 73px; height: 46px; font-size: 16px; display: inline-block; vertical-align: middle;">
                        <option value="010">010</option>
                        <option value="011">011</option>
                        <option value="016">016</option>
                        <option value="017">017</option>
                        <option value="018">018</option>
                        <option value="019">019</option>
                    </select>
                    <input type="text" class="form-control rounded-0" pattern="[0-9]*" id="mobile2" minlength="7" maxlength="8" style="width: 210px; margin-left: 12px; display: inline-block; vertical-align: middle;"><span id="msgNum"></span><span id="code2"></span>
                </div>

                <div class="col-auto">
                    <div class="form-group">
                        <label for="email" class="col-form-label">이메일</label>
                        <input type="text" name="email" id="email" placeholder="example@email.com"><span id="msg5"></span><span id="code3"></span>
                    </div>
                </div>
{##}
{#                    <div class="accordion" id="accordionPanelsStayOpenExample">#}
{#                        <div class="accordion-item">#}
{#                            <h2 class="accordion-header">#}
{#                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">#}
{#                                    <input class="form-check-input" type="checkbox" name="flexRadioDefault" id="flexRadioDefault1" >#}
{#                                    &nbsp; 이용약관 동의(필수)#}
{#                                </button>#}
{#                            </h2>#}
{#                            <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show">#}
{#                                <div class="accordion-body">#}
{#                                    <div style="font-size: 15px">#}
{#                                        제1조(목적) 이 약관은 업체 회사(전자상거래 사업자)가 운영하는 업체 사이버 몰(이하 “몰”이라 한다)에서 제공하는 인터넷 관련 서비스(이하 “서비스”라 한다)를 이용함에 있어 사이버 몰과 이용자의 권리․의무 및 책임사항을 규정함을 목적으로 합니다.#}
{##}
{#                                        ※「PC통신, 무선 등을 이용하는 전자상거래에 대해서도 그 성질에 반하지 않는 한 이 약관을 준용합니다.」#}
{##}
{#                                        제2조(정의)#}
{##}
{#                                        ① “몰”이란 업체 회사가 재화 또는 용역(이하 “재화 등”이라 함)을 이용자에게 제공하기 위하여 컴퓨터 등 정보통신설비를 이용하여 재화 등을 거래할 수 있도록 설정한 가상의 영업장을 말하며, 아울러 사이버몰을 운영하는 사업자의 의미로도 사용합니다.#}
{##}
{#                                        ② “이용자”란 “몰”에 접속하여 이 약관에 따라 “몰”이 제공하는 서비스를 받는 회원 및 비회원을 말합니다.#}
{##}
{#                                        ③ ‘회원’이라 함은 “몰”에 회원등록을 한 자로서, 계속적으로 “몰”이 제공하는 서비스를 이용할 수 있는 자를 말합니다.#}
{##}
{#                                        ④ ‘비회원’이라 함은 회원에 가입하지 않고 “몰”이 제공하는 서비스를 이용하는 자를 말합니다.#}
{##}
{#                                        제3조 (약관 등의 명시와 설명 및 개정)#}
{##}
{#                                        ① “몰”은 이 약관의 내용과 상호 및 대표자 성명, 영업소 소재지 주소(소비자의 불만을 처리할 수 있는 곳의 주소를 포함), 전화번호․모사전송번호․전자우편주소, 사업자등록번호, 통신판매업 신고번호, 개인정보관리책임자 등을 이용자가 쉽게 알 수 있도록 00 사이버몰의 초기 서비스화면(전면)에 게시합니다. 다만, 약관의 내용은 이용자가 연결화면을 통하여 볼 수 있도록 할 수 있습니다.#}
{##}
{#                                        ② “몰은 이용자가 약관에 동의하기에 앞서 약관에 정하여져 있는 내용 중 청약철회․배송책임․환불조건 등과 같은 중요한 내용을 이용자가 이해할 수 있도록 별도의 연결화면 또는 팝업화면 등을 제공하여 이용자의 확인을 구하여야 합니다.#}
{##}
{#                                        ③ “몰”은 「전자상거래 등에서의 소비자보호에 관한 법률」, 「약관의 규제에 관한 법률」, 「전자문서 및 전자거래기본법」, 「전자금융거래법」, 「전자서명법」, 「정보통신망 이용촉진 및 정보보호 등에 관한 법률」, 「방문판매 등에 관한 법률」, 「소비자기본법」 등 관련 법을 위배하지 않는 범위에서 이 약관을 개정할 수 있습니다.#}
{##}
{#                                        ④ “몰”이 약관을 개정할 경우에는 적용일자 및 개정사유를 명시하여 현행약관과 함께 몰의 초기화면에 그 적용일자 7일 이전부터 적용일자 전일까지 공지합니다. 다만, 이용자에게 불리하게 약관내용을 변경하는 경우에는 최소한 30일 이상의 사전 유예기간을 두고 공지합니다.  이 경우 &#034;몰“은 개정 전 내용과 개정 후 내용을 명확하게 비교하여 이용자가 알기 쉽도록 표시합니다.#}
{##}
{#                                        ⑤ “몰”이 약관을 개정할 경우에는 그 개정약관은 그 적용일자 이후에 체결되는 계약에만 적용되고 그 이전에 이미 체결된 계약에 대해서는 개정 전의 약관조항이 그대로 적용됩니다. 다만 이미 계약을 체결한 이용자가 개정약관 조항의 적용을 받기를 원하는 뜻을 제3항에 의한 개정약관의 공지기간 내에 “몰”에 송신하여 “몰”의 동의를 받은 경우에는 개정약관 조항이 적용됩니다.#}
{##}
{#                                        ⑥ 이 약관에서 정하지 아니한 사항과 이 약관의 해석에 관하여는 전자상거래 등에서의 소비자보호에 관한 법률, 약관의 규제 등에 관한 법률, 공정거래위원회가 정하는 「전자상거래 등에서의 소비자 보호지침」 및 관계법령 또는 상관례에 따릅니다.#}
{##}
{#                                        제4조(서비스의 제공 및 변경)#}
{##}
{#                                        ① “몰”은 다음과 같은 업무를 수행합니다.#}
{##}
{#                                        1. 재화 또는 용역에 대한 정보 제공 및 구매계약의 체결#}
{#                                        2. 구매계약이 체결된 재화 또는 용역의 배송#}
{#                                        3. 기타 “몰”이 정하는 업무#}
{##}
{#                                        ② “몰”은 재화 또는 용역의 품절 또는 기술적 사양의 변경 등의 경우에는 장차 체결되는 계약에 의해 제공할 재화 또는 용역의 내용을 변경할 수 있습니다. 이 경우에는 변경된 재화 또는 용역의 내용 및 제공일자를 명시하여 현재의 재화 또는 용역의 내용을 게시한 곳에 즉시 공지합니다.#}
{##}
{#                                        ③ “몰”이 제공하기로 이용자와 계약을 체결한 서비스의 내용을 재화 등의 품절 또는 기술적 사양의 변경 등의 사유로 변경할 경우에는 그 사유를 이용자에게 통지 가능한 주소로 즉시 통지합니다.#}
{##}
{#                                        ④ 전항의 경우 “몰”은 이로 인하여 이용자가 입은 손해를 배상합니다. 다만, “몰”이 고의 또는 과실이 없음을 입증하는 경우에는 그러하지 아니합니다.#}
{#                                    </div>#}
{#                                </div>#}
{#                            </div>#}
{#                        </div>#}
{#                        <div class="accordion-item">#}
{#                            <h2 class="accordion-header">#}
{#                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">#}
{#                                    Accordion Item #2#}
{#                                </button>#}
{#                            </h2>#}
{#                            <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">#}
{#                                <div class="accordion-body">#}
{#                                    <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.#}
{#                                </div>#}
{#                            </div>#}
{#                        </div>#}
{#                        <div class="accordion-item">#}
{#                            <h2 class="accordion-header">#}
{#                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">#}
{#                                    Accordion Item #3#}
{#                                </button>#}
{#                            </h2>#}
{#                            <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">#}
{#                                <div class="accordion-body">#}
{#                                    <strong>This is the third item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.#}
{#                                </div>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
{##}
{##}
{##}
{##}
{#                    <div class="col-auto">#}
{#                        <div class="form-group">#}
{#                            <div class="accordion" id="termsAccordion">#}
{#                                <div class="accordion-item">#}
{#                                    <h2 class="accordion-header" id="termsHeader">#}
{#                                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#termsCollapse" aria-expanded="true" aria-controls="termsCollapse">#}
{#                                            약관에 동의합니다.#}
{#                                        </button>#}
{#                                    </h2>#}
{#                                    <div id="termsCollapse" class="accordion-collapse collapse" aria-labelledby="termsHeader" data-bs-parent="#termsAccordion">#}
{#                                        <div class="accordion-body">#}
{#                                            <!-- 약관 내용을 여기에 추가 -->#}
{#                                        </div>#}
{#                                    </div>#}
{#                                </div>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}



                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <button type="button" class="form-control btn btn-outline-primary btn-lg theme-btn--primary-inverse sqs-button-element--primary" data-animation-role="header-element" id="joinbtn" style="transition-timing-function: ease; transition-duration: 0.4s; transition-delay: 0.172727s; animation-duration: 0.4s;">SIGN UP</button>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <button type="reset" class="form-control btn btn-outline-primary btn-lg theme-btn--primary-inverse sqs-button-element--primary" data-animation-role="header-element" style="transition-timing-function: ease; transition-duration: 0.4s; transition-delay: 0.172727s; animation-duration: 0.4s;">RESET</button>
                            </div>
                        </div>
                    </div>
                    <span id="msgButton"></span>

                    <input type="hidden" name="phone" id="phone">
                </div>
            </div>
        </form>

    </main>

{% endblock %}


{% block script %}

    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script>
        // 우편번호 찾기 찾기 화면을 넣을 element
        var element_wrap = document.getElementById('wrap');

        function foldDaumPostcode() {
            // iframe을 넣은 element를 안보이게 한다.
            element_wrap.style.display = 'none';
        }

        function execDaumPostcode() {
            // 현재 scroll 위치를 저장해놓는다.
            var currentScroll = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
            new daum.Postcode({
                oncomplete: function(data) {
                    // 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                    // 각 주소의 노출 규칙에 따라 주소를 조합한다.
                    // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                    var addr = ''; // 주소 변수
                    var extraAddr = ''; // 참고항목 변수

                    //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                    if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                        addr = data.roadAddress;
                    } else { // 사용자가 지번 주소를 선택했을 경우(J)
                        addr = data.jibunAddress;
                    }

                    // 사용자가 선택한 주소가 도로명 타입일때 참고항목을 조합한다.
                    if(data.userSelectedType === 'R'){
                        // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                        // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                        if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                            extraAddr += data.bname;
                        }
                        // 건물명이 있고, 공동주택일 경우 추가한다.
                        if(data.buildingName !== '' && data.apartment === 'Y'){
                            extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                        }
                        // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                        if(extraAddr !== ''){
                            extraAddr = ' (' + extraAddr + ')';
                        }
                        // 조합된 참고항목을 해당 필드에 넣는다.
                        document.getElementById("extraAddress").value = extraAddr;

                    } else {
                        document.getElementById("extraAddress").value = '';
                    }

                    // 우편번호와 주소 정보를 해당 필드에 넣는다.
                    document.getElementById('zipcode').value = data.zonecode;
                    document.getElementById("address1").value = addr;
                    // 커서를 상세주소 필드로 이동한다.
                    document.getElementById("address2").focus();

                    // iframe을 넣은 element를 안보이게 한다.
                    // (autoClose:false 기능을 이용한다면, 아래 코드를 제거해야 화면에서 사라지지 않는다.)
                    element_wrap.style.display = 'none';

                    // 우편번호 찾기 화면이 보이기 이전으로 scroll 위치를 되돌린다.
                    document.body.scrollTop = currentScroll;
                },
                // 우편번호 찾기 화면 크기가 조정되었을때 실행할 코드를 작성하는 부분. iframe을 넣은 element의 높이값을 조정한다.
                onresize : function(size) {
                    element_wrap.style.height = size.height+'px';
                },
                width : '100%',
                height : '100%'
            }).embed(element_wrap);

            // iframe을 넣은 element를 보이게 한다.
            element_wrap.style.display = 'block';
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){
            $('.accordion-button').click(function(){
                let targetCollapseId = $(this).attr('data-bs-target');
                let targetCollapse = $(targetCollapseId);

                if (targetCollapse.hasClass('show')) {
                    targetCollapse.removeClass('show');
                    targetCollapse.slideUp();
                } else {
                    targetCollapse.addClass('show');
                    targetCollapse.slideDown();
                }
            });
        });
    </script>




    <script>

        let msg1 = document.querySelector('#msg1');
        let msg2 = document.querySelector('#msg2');
        let msg3 = document.querySelector('#msg3');
        let msg4 = document.querySelector('#msg4');
        let msg5 = document.querySelector('#msg5');
        let msgAdd = document.querySelector('#msgAdd');
        let msgNum = document.querySelector('#msgNum');

        let useridInput = document.querySelector('#userid');
        let passwdInput = document.querySelector('#passwd');
        let repwdInput = document.querySelector('#repwd');
        let nameInput = document.querySelector('#name');
        let emailInput = document.querySelector('#email');
        let address1Input = document.querySelector('#address1');
        let address2Input = document.querySelector('#address2');
        let mobileInput = document.querySelector('#mobile2');
        // phone 요소 가져오기
        let phoneInput = document.querySelector('#phone');

        let joinfrm = document.joinfrm;

        // mobile1과 mobile2 요소 가져오기
        let mobile1Input = document.querySelector('#mobile1');
        let mobile2Input = document.querySelector('#mobile2');

        // mobile1과 mobile2의 값이 변경될 때마다 phone의 값을 업데이트하는 함수 정의
        let updatePhone = () => {
            phoneInput.value = mobile1Input.value + mobile2Input.value;
        };

        // mobile1과 mobile2의 값이 변경될 때마다 updatePhone 함수 호출
        mobile1Input.addEventListener('blur', updatePhone);
        mobile2Input.addEventListener('blur', updatePhone);



        // 입력 필드와 메시지 요소 초기화 함수
        let resetFieldAndMessage = (inputElement, messageElement) => {
            inputElement.style.border = ''; // 입력 필드 초기화
            messageElement.textContent = ''; // 메시지 초기화
        };

        // 메시지를 표시하고 입력 필드를 강조하는 함수
        let showMessage = (inputElement, messageElement, message) => {
            messageElement.textContent = message;
            messageElement.style.color = 'red'; // 메시지를 빨간색으로 강조
            inputElement.style.border = '1px solid red'; // 입력 필드 강조
        };

        // 메시지를 숨기고 입력 필드를 정상 상태로 돌리는 함수
        let hideMessage = (inputElement, messageElement) => {
            messageElement.textContent = ''; // 메시지 초기화
            messageElement.style.color = ''; // 메시지 텍스트 색상 초기화
            inputElement.style.border = ''; // 입력 필드 테두리를 기본값으로 설정
        };

        // 이벤트 핸들러 등록
        useridInput.addEventListener('blur', () => { checkuid(); });
        passwdInput.addEventListener('blur', () => { checkpwd(); });
        repwdInput.addEventListener('blur', () => { checkrepwd(); });
        emailInput.addEventListener('blur', () => { checkemail(); });
        nameInput.addEventListener('blur', () => { checkname(); });
        mobileInput.addEventListener('blur', () => { checkphone(); });



        // 폼 검증 함수
        let checkForm = () => {
            resetFieldAndMessage(useridInput, msg1);
            resetFieldAndMessage(passwdInput, msg2);
            resetFieldAndMessage(repwdInput, msg3);
            resetFieldAndMessage(address2Input, msgAdd);
            resetFieldAndMessage(nameInput, msg4);
            resetFieldAndMessage(mobileInput, msgNum);
            resetFieldAndMessage(emailInput, msg5);

            if (useridInput.value === '') {
                showMessage(useridInput, msg1, '아이디를 입력하세요');
                useridInput.focus();
                return false;
            } else if (passwdInput.value === '') {
                showMessage(passwdInput, msg2, '비밀번호를 입력하세요');
                passwdInput.focus();
                return false;
            } else if (repwdInput.value !== passwdInput.value || repwdInput.value === '') {
                showMessage(repwdInput, msg3, '비밀번호를 확인하세요');
                repwdInput.focus();
                return false;
            } else if (address2Input.value === '' || address1Input.value === '') {
                showMessage(address2Input, msgAdd, '주소를 입력해주세요.');
                address2Input.focus();
                return false;
            } else if (nameInput.value === '') {
                showMessage(nameInput, msg4, '이름을 입력하세요');
                nameInput.focus();
                return false;
            } else if (mobileInput.value === '') {
                showMessage(mobileInput, msgNum, '전화번호를 입력하세요');
                mobileInput.focus();
                return false;
            } else if (emailInput.value === '') {
                showMessage(emailInput, msg5, '이메일을 입력하세요');
                emailInput.focus();
                return false;
            } else if (checkuid() === false ) {
                document.getElementById("userid").focus();
                return false;
            } else if (checkpwd() === false ) {
                document.getElementById("passwd").focus();
                return false;
            } else if (checkrepwd() === false ) {
                document.getElementById("repwd").focus();
                return false;
            } else if (checkname() === false ) {
                document.getElementById("name").focus();
                return false;
            } else if (checkphone() === false ) {
                document.getElementById("phone").focus();
                return false;
            } else if (checkemail() === false) {
                document.getElementById("email").focus();
                return false;
            } else {
                return true;
            }
        };

        // 아이디 유효성 검사 함수
        let checkuid = () => {
            let uid = useridInput.value;
            let re = /^[a-z]+[a-z0-9]{4,15}$/g;
            let result = re.test(uid) ? '' : '아이디를 다시 입력해주세요.';
            if (result === '') {
                hideMessage(useridInput, msg1);
            } else {
                showMessage(useridInput, msg1, result);
                return false;
            }
        };

        // 비밀번호 유효성 검사 함수
        let checkpwd = () => {
            let pwd = passwdInput.value;
            let re = /^[a-z]+[a-z0-9]{4,15}$/g;
            let result = re.test(pwd) ? '' : '비밀번호를 다시 입력해주세요.';
            if (result === '') {
                hideMessage(passwdInput, msg2);
            } else {
                showMessage(passwdInput, msg2, result);
                return false;
            }
        };

        // 비밀번호 확인 함수
        let checkrepwd = () => {
            let result = repwdInput.value === passwdInput.value ? '' : '비밀번호가 일치하지 않습니다.';
            if (result === '') {
                hideMessage(repwdInput, msg3);
            } else {
                showMessage(repwdInput, msg3, result);
                return false;
            }
        };

        // 이름 유효성 검사 함수
        let checkname = () => {
            let name = nameInput.value;
            let re = /^[가-힣]{2,10}$/
            let result = re.test(name) ? '' : '이름을 다시 입력해주세요.';
            if (result === '') {
                hideMessage(nameInput, msg4);
            } else {
                showMessage(nameInput, msg4, result);
                return false;
            }
        };


        // 이메일 유효성 검사 함수
        let checkemail = () => {
            let email = emailInput.value;
            let re = /^(?:[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/;
            let result = re.test(email) ? '' : '이메일을 다시 입력해주세요.';
            if (result === '') {
                hideMessage(emailInput, msg5);
                return true;
            } else {
                showMessage(emailInput, msg5, result);
                return false;
            }
        };

        // 전화번호 유효성 검사 함수
        let checkphone = () => {
            let phone = mobileInput.value;
            let re = /^\d{7,8}$/;
            let result = re.test(phone) ? '' : '전화번호를 다시 입력해주세요.';
            if (result === '') {
                hideMessage(mobileInput, msgNum);
                return true;
            } else {
                showMessage(mobileInput, msgNum, result);
                return false;
            }
        };
    </script>

    <script>
        let joinbtn = document.querySelector('#joinbtn');
        joinfrm = document.joinfrm;
        joinbtn.addEventListener('click', () => {

            if (!checkForm()) {return;}  // checkForm 에서 넘어온게 true 일 경우에 작동

            // 폼에 입력된 데이터를 초기화함
            const formData = new FormData(joinfrm);
            // 서버에 보내기 위해 폼 데이터를 JSON 객체로 변환
            let jsondata = {};
            formData.forEach(function (val, key){
                jsondata[key] = val;
            });     // 작성된 데이터를 json 형태로 저장함
            // ajax를 이용해서 서버로 전송하고 결과 받음

            // delete jsondata['mobile2']
            // console.log(jsondata);

            fetch('http://127.0.0.1:8000/join', {
                method: 'POST',                     // 데이터 전송방식
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },                                  // 전송할 데이터 형식
                body: JSON.stringify(jsondata)      // 서버로 전송할 데이터
            })
                // .then((res) => res.json())          // 서버로부터 응답받음
                // .then((data) => console.log(data))  // 서버 데이터 콘솔에 출력
                // 잘 나오는거 확인하여 주석처리
                .then((res) => res.text())          // 서버로부터 응답받음 txt로 받음
                .then((data) => {
                    if (parseInt(data) > 0) location.href = '/joinok' // 회원가입 성공시 페이지 출력
                    else location.href = '/error'           // 회원가입 실패시 페이지 출력
                })
                .catch((err) => console.log(err));  // 오류발생시 콘솔에 출력
        });

    </script>

    <script>
        userid = document.querySelector('#userid');
        phone = document.querySelector('#phone');
        let code1 = document.querySelector('#code1');
        let code2 = document.querySelector('#code2');
        let code3 = document.querySelector('#code3');
        joinfrm = document.joinfrm;


        userid.addEventListener('blur', () => {

            // ajax를 이용해서 서버로 전송하고 결과 받음
            fetch(`http://127.0.0.1:8000/check/uid/${joinfrm.userid.value}`, {
                method: 'GET',                     // 데이터 전송방식
            })
                // .then((res) => res.json())          // 서버로부터 응답받음
                // .then((data) => console.log(data))  // 서버 데이터 콘솔에 출력
                // 잘 나오는거 확인하여 주석처리
                .then((res) => res.text())          // 서버로부터 응답받음 txt로 받음
                .then((data) => {
                    console.log(data);
                    hideMessage(useridInput, code1);
                    if (useridInput.value.length > 4) {
                        if (data === '"yes"') {
                            showMessage(useridInput, code1, '사용중인 아이디입니다.');
                            joinbtn.disabled = true;
                            useridInput.focus();

                        } else if (data === '"no"') {
                            hideMessage(useridInput, code1);
                            code1.textContent = '사용가능한 아이디입니다.';
                            joinbtn.disabled = false;
                            passwdInput.focus();
                        }
                    }
                })
                .catch((err) => console.log(err));  // 오류발생시 콘솔에 출력
        });

        mobile2Input.addEventListener('blur', () => {
            let isPhoneValid = checkphone();

            // Debugging
            console.log('isPhoneValid:', isPhoneValid);

            // ajax를 이용해서 서버로 전송하고 결과 받음
            fetch(`http://127.0.0.1:8000/check/phone/${joinfrm.phone.value}`, {
                method: 'GET',                     // 데이터 전송방식
            })
                .then((res) => res.text())          // 서버로부터 응답받음 txt로 받음
                .then((data) => {
                    console.log(data);
                    hideMessage(phoneInput, code2);
                    // checkphone() 함수의 결과에 따라 처리
                    if (!isPhoneValid) {
                        console.log(isPhoneValid);
                        return;
                    }
                    if (data === '"yes"' && isPhoneValid === true) {
                        showMessage(phoneInput, code2, '사용중인 전화번호입니다.');
                        joinbtn.disabled = true;
                        phoneInput.focus();
                    } else if (data === '"no"' && isPhoneValid === true) {
                        hideMessage(phoneInput, code2);
                        code2.textContent = '사용가능한 전화번호입니다.';
                        joinbtn.disabled = false;
                        emailInput.focus();
                    }
                })
                .catch((err) => console.log(err));  // 오류발생시 콘솔에 출력
        });

        emailInput.addEventListener('blur', () => {
            let isEmailValid = checkemail();

            // ajax를 이용해서 서버로 전송하고 결과 받음
            fetch(`http://127.0.0.1:8000/check/email/${joinfrm.email.value}`, {
                method: 'GET',                     // 데이터 전송방식
            })
                .then((res) => res.text())          // 서버로부터 응답받음 txt로 받음
                .then((data) => {
                    console.log(data);
                    hideMessage(emailInput, code3);

                    if (data === '"yes"' && isEmailValid === true) {
                        showMessage(emailInput, code3, '사용중인 이메일입니다.');
                        joinbtn.disabled = true;
                    } else if (data === '"no"' && isEmailValid === true) {
                        hideMessage(emailInput, code3);
                        code3.textContent = '사용가능한 이메일입니다.';
                        joinbtn.disabled = false;
                    }
                })
                .catch((err) => console.log(err));  // 오류발생시 콘솔에 출력
        });

    </script>



{% endblock %}


